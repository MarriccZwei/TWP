import Classes.hitboxes as hbx
test = True
'''Imported Hitboxes'''
corner1sImp = "-2012.115;-229.364;-16418.475|-2494.394;-246.41;-12639.887|-2976.673;-263.456;-8861.299|-3458.952;-280.501;-5082.712|736.659;-619.849;-7328.047"
corner2sImp = "-161.142;73.563;-16109.548|-643.421;56.518;-12330.96|-1125.7;39.472;-8552.373|-1607.979;22.426;-4773.785|1043.578;391.811;-6316.771"

corner1s = hbx.uncodePoints(corner1sImp)
corner2s = hbx.uncodePoints(corner2sImp)

#generating hitboxes from imported points
hitboxes = [hbx.Hitbox(corner1s[i], corner2s[i]) for i in range(len(corner1s))]

'''Imported Cell Edges'''
cellPtsImp = "-1220.923;268.295;-35|-1218.963;-267.024;-35|-1179.317;255.554;-1288.208|-1177.448;-254.966;-1288.207|1179.176;178.308;-1288.208|1178.214;-141.255;-1288.207&-1176.993;254.842;-1358.208|-1175.129;-254.293;-1358.207|-1120.48;237.536;-3060.412|-1118.74;-237.915;-3060.41|1120.351;164.144;-3060.411|1119.466;-129.874;-3060.41&-1118.156;236.824;-3130.412|-1116.421;-237.242;-3130.41|-1061.644;219.518;-4832.616|-1060.032;-220.864;-4832.613|1061.525;149.979;-4832.615|1060.718;-118.492;-4832.614&-1059.32;218.806;-4902.616|-1057.713;-220.19;-4902.613|-998.392;200.147;-6737.823|-996.918;-202.533;-6737.82|998.285;134.752;-6737.823|997.56;-106.257;-6737.821&-996.068;199.436;-6807.823|-994.599;-201.86;-6807.82|-936.197;181.101;-8611.205|-934.858;-184.509;-8611.2|936.102;119.779;-8611.204|935.458;-94.226;-8611.202&-933.873;180.389;-8681.205|-932.54;-183.835;-8681.2|-873.473;161.892;-10500.5|-872.272;-166.331;-10500.494|873.39;104.679;-10500.499|872.828;-82.092;-10500.495&-871.149;161.18;-10570.5|-869.953;-165.657;-10570.494|-810.749;142.684;-12389.795|-809.685;-148.153;-12389.788|810.678;89.578;-12389.793|810.198;-69.959;-12389.789&-808.425;141.972;-12459.795|-807.366;-147.48;-12459.788|-748.025;123.475;-14279.089|-747.098;-129.976;-14279.081|747.966;74.478;-14279.088|747.568;-57.826;-14279.084&-745.701;122.763;-14349.089|-744.779;-129.302;-14349.081|-685.302;104.267;-16168.384|-684.511;-111.798;-16168.375|685.254;59.378;-16168.382|684.938;-45.693;-16168.378&-682.978;103.555;-16238.384|-682.192;-111.124;-16238.375|-620.481;84.416;-18120.838|-619.832;-93.013;-18120.828|620.446;43.773;-18120.836|620.215;-33.154;-18120.831"
cellPts = [hbx.uncodePoints(cellTop) for cellTop in cellPtsImp.split('&')]
# cellTopsImp = "-19.382;-170;-16457.981|-19.353;-179.571;-18037.536|-2447.738;-297.517;-17952.984&-57.371;-171.763;-16446.147|-2381.874;-283.665;-16446.147|-2481.01;-299.032;-17938.245&-19.412;-160.044;-14816.521|-19.383;-169.737;-16416.147|-2347.581;-281.817;-16416.147&-52.743;-161.547;-14803.032|-2272.703;-266.736;-14803.032|-2378.892;-283.214;-16401.27&-19.443;-150.081;-13174.183|-19.413;-159.769;-14773.033|-2240.223;-264.999;-14773.033&-50.961;-151.467;-13159.917|-2163.533;-249.787;-13159.917|-2269.662;-266.276;-14757.27&-19.473;-140.118;-11531.932|-19.444;-149.8;-13129.918|-2132.852;-248.16;-13129.918&-49.192;-141.386;-11516.802|-2054.362;-232.814;-11516.802|-2160.426;-249.318;-13113.166&-19.504;-130.153;-9889.785|-19.475;-139.83;-11486.803|-2025.466;-231.296;-11486.803&-47.438;-131.304;-9873.688|-1945.191;-215.813;-9873.688|-2051.181;-232.335;-11468.939&-19.535;-120.187;-8247.76|-19.505;-129.858;-9843.688|-1918.064;-214.403;-9843.688&-45.699;-121.22;-8230.573|-1836.019;-198.778;-8230.573|-1941.926;-215.322;-9824.566&-19.565;-110.221;-6605.879|-19.536;-119.883;-8200.574|-1810.645;-197.475;-8200.574&-43.978;-111.135;-6587.458|-1726.848;-181.7;-6587.458|-1832.659;-198.273;-8180.018&-19.596;-100.252;-4964.172|-19.567;-109.906;-6557.459|-1703.205;-180.503;-6557.459&-42.277;-101.048;-4944.344|-1617.676;-164.57;-4944.344|-1723.378;-181.18;-6535.257&-19.627;-90.281;-3322.676|-19.598;-99.926;-4914.344|-1595.744;-163.479;-4914.344&-40.598;-90.957;-3301.229|-1508.504;-147.375;-3301.229|-1614.08;-164.032;-4890.236&-19.658;-80.308;-1681.439|-19.629;-89.941;-3271.23|-1488.258;-146.387;-3271.23&-38.942;-80.862;-1658.114|-1399.331;-130.094;-1658.114|-1504.759;-146.816;-3244.892&-19.689;-70.332;-40.524|-19.66;-79.951;-1628.115|-1380.746;-129.209;-1628.115&-37.313;-70.761;-14.999|-1290.158;-112.701;-14.999|-1395.411;-129.51;-1599.139"
# cellTops = [hbx.uncodePoints(cellTop) for cellTop in cellTopsImp.split('&')]

# cellBotsImp = "-20.58;169.165;-16458.589|-20.61;178.976;-18079.718|-2450.667;296.448;-18018.85&-56.717;170.84;-16446.147|-2379.565;283.326;-16446.147|-2482.953;297.921;-18003.937&-20.551;159.226;-14816.545|-20.58;168.907;-16416.147|-2345.33;281.486;-16416.147&-53.823;160.754;-14803.032|-2270.514;267.927;-14803.032|-2376.585;282.907;-16401.246&-20.521;149.286;-13174.207|-20.55;158.962;-14773.033|-2238.088;266.176;-14773.033&-51.984;150.718;-13159.917|-2161.462;252.521;-13159.917|-2267.475;267.499;-14757.246&-20.491;139.345;-11531.958|-20.52;149.016;-13129.918|-2130.833;250.859;-13129.918&-50.158;140.683;-11516.803|-2052.411;237.106;-11516.803|-2158.358;252.083;-13113.141&-20.461;129.406;-9889.811|-20.49;139.071;-11486.803|-2023.563;235.533;-11486.803&-48.346;130.648;-9873.688|-1943.36;221.68;-9873.688|-2049.233;236.658;-11468.913&-20.431;119.466;-8247.787|-20.46;129.125;-9843.688|-1916.277;220.195;-9843.688&-46.551;120.614;-8230.573|-1834.309;206.241;-8230.573|-1940.098;221.22;-9824.54&-20.401;109.528;-6605.907|-20.43;119.179;-8200.574|-1808.974;204.844;-8200.574&-44.773;110.58;-6587.458|-1725.257;190.787;-6587.458|-1830.951;205.768;-8179.991&-20.371;99.59;-4964.2|-20.4;109.232;-6557.459|-1701.652;189.476;-6557.459&-43.015;100.546;-4944.344|-1616.206;175.311;-4944.344|-1721.791;190.298;-6535.23&-20.342;89.652;-3322.705|-20.371;99.285;-4914.344|-1594.308;174.086;-4914.344&-41.278;90.512;-3301.229|-1507.155;159.809;-3301.229|-1612.613;174.804;-4890.209&-20.312;79.716;-1681.468|-20.341;89.337;-3271.23|-1486.94;158.668;-3271.23&-39.565;80.478;-1658.114|-1398.104;144.271;-1658.114|-1503.414;159.281;-3244.864&-20.282;69.78;-40.553|-20.311;79.388;-1628.115|-1379.546;143.214;-1628.115&-37.878;70.444;-15|-1289.054;128.685;-15|-1394.188;143.718;-1599.112"
# cellBots = [hbx.uncodePoints(cellBot) for cellBot in cellBotsImp.split('&')]

# cells:hbx.List[hbx.Cell] = list()
# for i in range(len(cellBots)):
#     cells.append(hbx.Cell(cellBots[i], cellTops[i]))

cells = [hbx.Cell(pts) for pts in cellPts]
batteries:hbx.List[hbx.Battery] = list()
batteryTemplate = hbx.Battery((0,0,0), 237.521, 118.76, 257.521)
for c in cells:
    batteries += c.populate(batteryTemplate, 10, hitboxes)

returnstr = ';'.join([str(b.corner1[0]) for b in batteries])+'|'+';'.join([str(b.corner1[1]) for b in batteries])+'|'+';'.join([str(b.corner1[2]) for b in batteries])+'|'
returnstr += ';'.join([str(b.corner2[0]) for b in batteries])+'|'+';'.join([str(b.corner2[1]) for b in batteries])+'|'+';'.join([str(b.corner2[2]) for b in batteries])
with open("vsScripts/batPos.txt", 'w') as batPosLog:
    batPosLog.write(returnstr)

if test:
    #testing if coordinates have been imported properly
    import matplotlib.pyplot as plt
    xs = [pt[0] for pt in corner1s]+[pt[0] for pt in corner2s]
    zs = [pt[2] for pt in corner1s]+[pt[2] for pt in corner2s]

    for i in cellPts:
        plt.plot([pt[0] for pt in i], [pt[2] for pt in i])

    #testing if the tops and bottoms of the cells correspond to each other
    # plt.plot([pt[0] for pt in cellBots[5]], [pt[2] for pt in cellBots[5]])
    # plt.plot([pt[0] for pt in cellTops[5]], [pt[2] for pt in cellTops[5]])
    # plt.plot([cellTops[8][0][0]]+[cellTops[8][1][0]], [cellTops[8][0][2]]+[cellTops[8][1][2]])

    plt.scatter([b.corner1[0] for b in batteries], [b.corner1[2] for b in batteries])
    plt.scatter([b.corner2[0] for b in batteries], [b.corner2[2] for b in batteries])

    plt.scatter(xs, zs)
    plt.show()
    print(len(batteries))